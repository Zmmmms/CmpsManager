"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){function n(a,s){try{var i=e[a](s),o=i.value}catch(t){return void r(t)}if(!i.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});t(o)}return n("next")})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_wxRequest=require("./../../utils/wxRequest/index.js"),_wxRequest2=_interopRequireDefault(_wxRequest),_wxchartMin=require("./../../utils/wxchart.min.js"),_wxchartMin2=_interopRequireDefault(_wxchartMin),_statement=require("./../../components/index/statement.js"),_statement2=_interopRequireDefault(_statement),_empty=require("./../../components/empty.js"),_empty2=_interopRequireDefault(_empty),MonthsIndex=function(t){function e(){var t,r,n,a;_classCallCheck(this,e);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=n=_possibleConstructorReturn(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(i))),n.config={navigationBarTitleText:"月账单"},n.data={info:{},year:0,month:0,dashboard:{},expendChart:{},dayChart:{},weekChart:{},surplusChart:{},budgetChart:{},totalAsset:{},userinfo:{},lastTen:[],emptyTitle:"找不到相关数据呢，请多记账吧：）"},n.$repeat={lastTen:{com:"StatementItem",props:"statement.sync"}},n.$props={StatementItem:{"v-bind:statement.sync":{value:"item",type:"item",for:"lastTen",item:"item",index:"index",key:"index"}},Empty:{"xmlns:v-bind":"","v-bind:title.sync":"emptyTitle"}},n.$events={},n.components={StatementItem:_statement2.default,Empty:_empty2.default},n.computed={expendPercent:function(){var t=this.dashboard.expend,e=1*this.dashboard.income+1*this.dashboard.expend+Math.abs(1*this.dashboard.surplus);return 0==e||0==t?"10%":100*t/e+"%"},incomePercent:function(){var t=this.dashboard.income,e=1*this.dashboard.income+1*this.dashboard.expend+Math.abs(1*this.dashboard.surplus);return 0==e||0==t?"10%":100*t/e+"%"},surplusPercent:function(){var t=Math.abs(1*this.dashboard.surplus),e=1*this.dashboard.income+1*this.dashboard.expend+Math.abs(1*this.dashboard.surplus);return 0==e||0==t?"10%":100*t/e+"%"},assetPercent:function(){var t=1*this.totalAsset.all_asset,e=1*this.totalAsset.all_asset+1*this.totalAsset.net_worth+1*this.totalAsset.total_liability;return 0==e||0==t?"10%":100*t/e+"%"},netPercent:function(){var t=1*this.totalAsset.net_worth,e=1*this.totalAsset.all_asset+1*this.totalAsset.net_worth+1*this.totalAsset.total_liability;return 0==e||0==t?"10%":100*t/e+"%"},debtPercent:function(){var t=1*this.totalAsset.total_liability,e=1*this.totalAsset.all_asset+1*this.totalAsset.net_worth+1*this.totalAsset.total_liability;return 0==e||0==t?"10%":100*t/e+"%"}},a=r,_possibleConstructorReturn(n,a)}return _inherits(e,t),_createClass(e,[{key:"onLoad",value:function(t){this.year=t.year,this.month=t.month,this.information(),this.initDashboardChart(),this.initExpendChart(),this.initDayAvgChart(),this.initWeekAvgChart(),this.initSurplusChart(),this.initBudgetChart(),this.initAssetAllChart(),this.initLast10(),this.markRead(t.id)}},{key:"onShow",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wepy2.default.getSystemInfo();case 2:this.info=t.sent;case 3:case"end":return t.stop()}},t,this)}));return t}()},{key:"initDashboardChart",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"dashboard_chart",year:this.year,month:this.month});case 2:e=t.sent,this.dashboard=e,this.$apply(),null!=e.data&&new _wxchartMin2.default({canvasId:"monthChart",type:"pie",series:e.data,width:this.info.screenWidth,height:280});case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"initExpendChart",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"expend_compare",year:this.year,month:this.month});case 2:e=t.sent,this.expendChart=e,this.$apply(),e.categories.length>0&&new _wxchartMin2.default({canvasId:"expendChart",type:"column",categories:e.categories,series:[{name:"上月",data:e.last_month},{name:"当月",data:e.current_month}],yAxis:{format:function(t){return t+"元"}},width:this.info.screenWidth,height:200});case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"initDayAvgChart",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"day_avg_chart",year:this.year,month:this.month});case 2:e=t.sent,this.dayChart=e,this.$apply(),e.months.length>0&&new _wxchartMin2.default({canvasId:"dayAvgChart",type:"line",categories:e.months,series:[{name:"日均消费",data:e.data}],yAxis:{title:"消费金额 (元)",min:0},extra:{lineStyle:"curve"},width:320,height:200});case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"initWeekAvgChart",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"week_avg_chart",year:this.year,month:this.month});case 2:e=t.sent,this.weekChart=e,this.$apply(),e.weeks.length>0&&new _wxchartMin2.default({canvasId:"weekChart",type:"line",categories:e.weeks,series:[{name:"每周消费",data:e.data}],yAxis:{title:"消费金额 (元)",min:0},extra:{lineStyle:"curve"},width:320,height:200});case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"initSurplusChart",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"month_surplus_chart",year:this.year,month:this.month});case 2:e=t.sent,this.surplusChart=e,this.$apply(),e.months.length>0&&new _wxchartMin2.default({canvasId:"surplusChart",type:"line",categories:e.months,series:[{name:"月均消费",data:e.data}],yAxis:{title:"消费金额 (元)",min:0},extra:{lineStyle:"curve"},width:320,height:200});case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"initAssetAllChart",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"asset_total_chart",year:this.year,month:this.month});case 2:e=t.sent,this.totalAsset=e,this.$apply(),null!=e.data&&new _wxchartMin2.default({canvasId:"assetAllChart",type:"ring",series:e.data,yAxis:{title:"消费金额 (元)",min:0},width:320,height:280,dataLabel:!1});case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"initBudgetChart",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"budget_chart",year:this.year,month:this.month});case 2:e=t.sent,this.budgetChart=e,this.$apply(),e.categories.length>0&&new _wxchartMin2.default({canvasId:"budgetChart",type:"column",categories:e.categories,series:[{name:"预算",data:e.budget},{name:"实际消费",data:e.amount}],yAxis:{format:function(t){return t+"元"}},width:this.info.screenWidth,height:200});case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"information",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"information",year:this.year,month:this.month});case 2:e=t.sent,this.userinfo=e,this.$apply();case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"initLast10",value:function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("super_chart/month_chart",{type:"month_last_10",year:this.year,month:this.month});case 2:e=t.sent,this.lastTen=e,this.$apply();case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"markRead",value:function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_wxRequest2.default.Get("message/"+e,{});case 2:case"end":return t.stop()}},t,this)}));return t}()}]),e}(_wepy2.default.page);Page(require("./../../npm/wepy/lib/wepy.js").default.$createPage(MonthsIndex,"pages/months/index"));