"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,u){try{var a=t[o](u),i=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}return n("next")})}}Object.defineProperty(exports,"__esModule",{value:!0});var _wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_host=require("./../host.js"),_host2=_interopRequireDefault(_host),doRequest=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(r,n,o){var u,a,i,s,c,f,p,d,l=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments[4]);return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(u=[],a=getCurrentPages(),!(a.length>0)){t.next=22;break}for(i=!0,s=!1,c=void 0,t.prev=6,f=a[Symbol.iterator]();!(i=(p=f.next()).done);i=!0)d=p.value,u.push(d.route);t.next=14;break;case 10:t.prev=10,t.t0=t.catch(6),s=!0,c=t.t0;case 14:t.prev=14,t.prev=15,!i&&f.return&&f.return();case 17:if(t.prev=17,!s){t.next=20;break}throw c;case 20:return t.finish(17);case 21:return t.finish(14);case 22:return t.abrupt("return",_wepy2.default.request({url:r,method:n,data:o,header:{"content-type":"application/x-www-form-urlencoded"}}).then(function(t){var n=t.statusCode;if(200===n){var o=t.data;return void 0!==l&&l(o),o}if(r===_host2.default.url+"/error_upload")return!1;500!=n&&404!=n&&e.errMsg,wx.showToast({title:"网络请求超时..",icon:"none",duration:3e3})},function(e){wx.showToast({title:"请求不可达",icon:"none",duration:3e3})}));case 23:case"end":return t.stop()}},t,void 0,[[6,10,14,22],[15,,17,21]])}));return function(e,r,n){return t.apply(this,arguments)}}();exports.default={doRequest:doRequest};