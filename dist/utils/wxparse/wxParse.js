"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function wxParse(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wxParseData",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"html",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:'<div class="color:red;">数据不能为空</div>',r=arguments[3],i=arguments[4],o=r,n={};if("html"==a)n=_html2json2.default.html2json(t,e),console.log(JSON.stringify(n," "," "));else if("md"==a||"markdown"==a){var s=new _showdown2.default.Converter,d=s.makeHtml(t);n=_html2json2.default.html2json(d,e),console.log(JSON.stringify(n," "," "))}n.view={},n.view.imagePadding=0,void 0!==i&&(n.view.imagePadding=i);var l={};return l[e]=n,o.setData(l),o.wxParseImgLoad=wxParseImgLoad,o.wxParseImgTap=wxParseImgTap,l.wxParseImgLoad=wxParseImgLoad,l.wxParseImgTap=wxParseImgTap,l}function wxParseImgTap(e){var a=this,t=e.target.dataset.src,r=e.target.dataset.from;void 0!==r&&r.length>0&&wx.previewImage({current:t,urls:a.data[r].imageUrls})}function wxParseImgLoad(e){var a=this,t=e.target.dataset.from,r=e.target.dataset.idx;void 0!==t&&t.length>0&&calMoreImageInfo(e,r,a,t)}function calMoreImageInfo(e,a,t,r){var i,o=t.data[r];if(o&&0!=o.images.length){var n=o.images,s=wxAutoImageCal(e.detail.width,e.detail.height,t,r),d=n[a].index,l=""+r,g=!0,m=!1,w=void 0;try{for(var h,u=d.split(".")[Symbol.iterator]();!(g=(h=u.next()).done);g=!0){l+=".nodes["+h.value+"]"}}catch(e){m=!0,w=e}finally{try{!g&&u.return&&u.return()}finally{if(m)throw w}}var f=l+".width",v=l+".height";t.setData((i={},_defineProperty(i,f,s.imageWidth),_defineProperty(i,v,s.imageheight),i))}}function wxAutoImageCal(e,a,t,r){var i=0,o=0,n=0,s={},d=t.data[r].view.imagePadding;return i=realWindowWidth-2*d,realWindowHeight,e>i?(o=i,n=o*a/e,s.imageWidth=o,s.imageheight=n):(s.imageWidth=e,s.imageheight=a),s}function wxParseTemArray(e,a,t,r){for(var i=[],o=r.data,n=null,s=0;s<t;s++){var d=o[a+s].nodes;i.push(d)}e=e||"wxParseTemArray",n=JSON.parse('{"'+e+'":""}'),n[e]=i,r.setData(n)}function emojisInit(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/wxParse/emojis/",t=arguments[2];_html2json2.default.emojisInit(e,a,t)}var _showdown=require("./showdown.js"),_showdown2=_interopRequireDefault(_showdown),_html2json=require("./html2json.js"),_html2json2=_interopRequireDefault(_html2json),realWindowWidth=0,realWindowHeight=0;wx.getSystemInfo({success:function(e){realWindowWidth=e.windowWidth,realWindowHeight=e.windowHeight}}),module.exports={wxParse:wxParse,wxParseTemArray:wxParseTemArray,emojisInit:emojisInit};