"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),_wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),Caculate=function(t){function i(){var t,e,n,s;_classCallCheck(this,i);for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=n=_possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(r))),n.props={showCaculation:{type:Boolean,default:!1,twoWay:!0},showFormula:{type:Boolean,default:!0},showScreen:{type:Boolean,default:!1},amount:{type:String,default:"0",twoWay:!0}},n.data={formula:"",op:{plus:"+",minus:"-"},opArr:["+","-"],infix:[],suffix:[],lastVal:0},n.methods={hideCaculation:function(){this.showCaculation=!1},caculatBtn:function(t){var i=t.target.dataset.num,e=parseInt(i,10);isNaN(e)?this.buildOpInfix(this.op[i]):(this.buildNumberInfix(e),this.calculate())},backspace:function(){var t=parseInt(this.amount,10).toString();if(1==t.split("").length)return void this.resetData();var i=t.substr(0,t.length-1);this.lastVal=i,this.infix=[parseInt(i,10)],this.calculate()},caculatok:function(){this.resetData(!1),this.showCaculation=!1,this.$emit("invokeCaculation",this.amount)}},s=e,_possibleConstructorReturn(n,s)}return _inherits(i,t),_createClass(i,[{key:"resetData",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.infix=[],this.suffix=[],this.lastVal=0,this.formula="",t&&(this.amount="0.00")}},{key:"isOp",value:function(t){return t&&-1!==this.opArr.indexOf(t)}},{key:"priorHigher",value:function(t,i){return!("+"!==t&&"-"!==t||"*"!==i&&"/"!==i)}},{key:"opCalc",value:function(t,i,e){switch(e=parseInt(e,10),t=parseInt(t,10),i){case"+":return e+t;case"-":return Math.max(0,e-t);default:return 0}}},{key:"buildNumberInfix",value:function(t){this.isOp(this.lastVal)||(t=10*this.lastVal+t,this.infix.pop()),this.lastVal=t,this.infix.push(t)}},{key:"buildOpInfix",value:function(t){0==this.infix.length&&this.infix.push(parseInt(this.amount,10)),this.isOp(this.lastVal)&&this.infix.pop(),this.lastVal=t,this.infix.push(t)}},{key:"calculate",value:function(t){this.infix.length%2==0&&1!=this.infix.length||(this.infix2Suffix(),this.calcSuffix())}},{key:"calcSuffix",value:function(){for(var t=[],i=0;i<this.suffix.length;i++)this.isOp(this.suffix[i])?t.push(this.opCalc(t.pop(),this.suffix[i],t.pop())):t.push(this.suffix[i]);this.amount=0==t.length?"0.00":t[0]+".00"}},{key:"infix2Suffix",value:function(){var t=[];this.suffix=[];for(var i=0;i<this.infix.length;i++)if(this.isOp(this.infix[i]))if(t.length){var e=t[t.length-1];if(!this.priorHigher(e,this.infix[i]))for(;t.length&&!this.priorHigher(e,this.infix[i]);)this.suffix.push(t.pop()),e=t[t.length-1];t.push(this.infix[i])}else t.push(this.infix[i]);else this.suffix.push(this.infix[i]);for(;t.length;)this.suffix.push(t.pop())}}]),i}(_wepy2.default.component);exports.default=Caculate;